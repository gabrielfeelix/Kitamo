import{d as V,c as p,h as g,z as F,g as n,f as D,a as O,b,D as P,w as M,i as c,e as t,o as i,l as R,t as r,n as u,F as B,r as H,G as z,H as q,C as G}from"./app-gwvRBHRb.js";import{u as J,_ as Q,r as x}from"./useIsMobile-CpoefEyf.js";import{_ as W}from"./DesktopShell.vue_vue_type_script_setup_true_lang-B6p_nF9i.js";const Y={key:0,class:"flex items-center gap-3 pt-2"},K={class:"flex-1"},U={class:"text-xs font-semibold text-slate-400"},X={class:"flex items-center gap-2"},Z=["disabled"],tt={key:1,class:"flex items-center justify-between"},et={class:"text-sm font-semibold text-slate-500"},st={class:"flex items-center gap-2"},at=["disabled"],ot=["disabled"],lt={class:"mt-4"},it={class:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide"},nt={key:2,class:"mt-8 rounded-3xl border border-dashed border-slate-200 bg-slate-50 px-5 py-10 text-center md:mx-auto md:max-w-2xl"},dt={key:3,class:"mt-6 space-y-3 md:mx-auto md:max-w-2xl"},rt={class:"flex items-start justify-between gap-4"},ut={class:"flex min-w-0 gap-3"},ct={class:"flex h-10 w-10 shrink-0 items-center justify-center rounded-2xl bg-slate-50 ring-1 ring-slate-200/60"},xt={class:"min-w-0"},mt={class:"mt-1 text-xs text-slate-500"},ft={key:0,class:"mt-2 text-[11px] font-semibold text-slate-400"},vt={class:"flex items-center gap-2"},pt=["onClick"],bt=["onClick"],ht={key:1,class:"h-2 w-2 shrink-0 rounded-full bg-red-500"},kt=V({__name:"Index",setup(yt){const m=J(),S=p(()=>m.value?Q:W),A=p(()=>m.value?{showNav:!1}:{title:"NotificaÃ§Ãµes",subtitle:"Central de alertas",showSearch:!1,showNewAction:!1}),d=g(!1),l=g([]),h=p(()=>l.value.filter(s=>!s.read_at).length),o=g("all"),y=s=>new Date(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0,0),w=(s,e)=>y(s).getTime()===y(e).getTime(),k=p(()=>{if(o.value==="all")return l.value;const e=y(new Date),a=new Date(e);a.setDate(a.getDate()-1);const f=o.value==="7d"?7:o.value==="30d"?30:0,v=f?new Date(e):null;return v&&v.setDate(v.getDate()-(f-1)),l.value.filter(I=>{const _=new Date(I.created_at);return o.value==="today"?w(_,e):o.value==="yesterday"?w(_,a):o.value==="7d"||o.value==="30d"?_>=v:!0})}),N=async()=>{d.value=!0;try{const s=await x(route("api.notifications.index"));l.value=s.notifications??[]}finally{d.value=!1}},T=s=>{try{return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}).format(new Date(s))}catch{return""}},$=s=>s==="vencimento"?"â°":s==="alerta_saldo"?"âš ï¸":s==="resumo_semanal"?"ðŸ“Š":"ðŸ””",E=async s=>{await x(route("api.notifications.read",s),{method:"PATCH"}),l.value=l.value.map(e=>e.id===s?{...e,read_at:new Date().toISOString()}:e)},j=async()=>{await x(route("api.notifications.read-all"),{method:"POST"});const s=new Date().toISOString();l.value=l.value.map(e=>e.read_at?e:{...e,read_at:s})},C=async()=>{await x(route("api.notifications.clear-read"),{method:"DELETE"}),l.value=l.value.filter(s=>!s.read_at)},L=async s=>{await x(route("api.notifications.delete",s),{method:"DELETE"}),l.value=l.value.filter(e=>e.id!==s)};return F(N),(s,e)=>(i(),n(B,null,[D(b(P),{title:"NotificaÃ§Ãµes"}),(i(),O(G(S.value),z(q(A.value)),{default:M(()=>[b(m)?(i(),n("header",Y,[D(b(R),{href:s.route("dashboard"),class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-white text-slate-600 shadow-sm ring-1 ring-slate-200/60","aria-label":"Voltar"},{default:M(()=>[...e[5]||(e[5]=[t("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M15 18l-6-6 6-6"})],-1)])]),_:1},8,["href"]),t("div",K,[e[6]||(e[6]=t("div",{class:"text-xl font-semibold tracking-tight text-slate-900"},"NotificaÃ§Ãµes",-1)),t("div",U,r(h.value)+" nÃ£o lidas",1)]),t("div",X,[t("button",{type:"button",class:"rounded-2xl bg-slate-100 px-4 py-2 text-xs font-semibold text-slate-600 disabled:opacity-60",onClick:C,disabled:d.value||l.value.every(a=>!a.read_at)}," Limpar ",8,Z)])])):c("",!0),b(m)?c("",!0):(i(),n("div",tt,[t("div",et,r(h.value)+" nÃ£o lidas",1),t("div",st,[t("button",{type:"button",class:"rounded-2xl bg-slate-100 px-4 py-2 text-sm font-semibold text-slate-600 disabled:opacity-60",onClick:j,disabled:d.value||h.value===0}," Marcar todas como lidas ",8,at),t("button",{type:"button",class:"rounded-2xl bg-slate-100 px-4 py-2 text-sm font-semibold text-slate-600 disabled:opacity-60",onClick:C,disabled:d.value||l.value.every(a=>!a.read_at)}," Limpar lidas ",8,ot)])])),t("div",lt,[t("div",it,[t("button",{type:"button",class:u(["shrink-0 rounded-full px-4 py-2 text-xs font-semibold transition",o.value==="today"?"bg-[#14B8A6] text-white":"bg-slate-100 text-slate-600"]),onClick:e[0]||(e[0]=a=>o.value="today")}," Hoje ",2),t("button",{type:"button",class:u(["shrink-0 rounded-full px-4 py-2 text-xs font-semibold transition",o.value==="yesterday"?"bg-[#14B8A6] text-white":"bg-slate-100 text-slate-600"]),onClick:e[1]||(e[1]=a=>o.value="yesterday")}," Ontem ",2),t("button",{type:"button",class:u(["shrink-0 rounded-full px-4 py-2 text-xs font-semibold transition",o.value==="7d"?"bg-[#14B8A6] text-white":"bg-slate-100 text-slate-600"]),onClick:e[2]||(e[2]=a=>o.value="7d")}," Ãšltimos 7 dias ",2),t("button",{type:"button",class:u(["shrink-0 rounded-full px-4 py-2 text-xs font-semibold transition",o.value==="30d"?"bg-[#14B8A6] text-white":"bg-slate-100 text-slate-600"]),onClick:e[3]||(e[3]=a=>o.value="30d")}," Ãšltimos 30 dias ",2),t("button",{type:"button",class:u(["shrink-0 rounded-full px-4 py-2 text-xs font-semibold transition",o.value==="all"?"bg-[#14B8A6] text-white":"bg-slate-100 text-slate-600"]),onClick:e[4]||(e[4]=a=>o.value="all")}," Todos ",2)])]),!k.value.length&&!d.value?(i(),n("div",nt,[...e[7]||(e[7]=[t("div",{class:"mx-auto flex h-12 w-12 items-center justify-center rounded-2xl bg-white text-slate-400"},[t("svg",{class:"h-6 w-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M15 17h5l-1.4-1.4A2 2 0 0 1 18 14V11a6 6 0 1 0-12 0v3a2 2 0 0 1-.6 1.6L4 17h5"}),t("path",{d:"M9 17a3 3 0 0 0 6 0"})])],-1),t("div",{class:"mt-3 text-sm font-semibold text-slate-900"},"Sem notificaÃ§Ãµes",-1),t("div",{class:"mt-1 text-xs text-slate-500"},"Quando algo importante acontecer, avisamos por aqui.",-1)])])):(i(),n("div",dt,[(i(!0),n(B,null,H(k.value,a=>(i(),n("div",{key:a.id,class:"rounded-3xl bg-white px-5 py-4 shadow-sm ring-1 ring-slate-200/60"},[t("div",rt,[t("div",ut,[t("div",ct,r($(a.type)),1),t("div",xt,[t("div",{class:u(["truncate text-sm font-semibold",a.read_at?"text-slate-700":"text-slate-900"])},r(a.title),3),t("div",mt,r(a.body),1),a.created_at?(i(),n("div",ft,r(T(a.created_at)),1)):c("",!0)])]),t("div",vt,[a.read_at?c("",!0):(i(),n("button",{key:0,type:"button",class:"rounded-xl bg-slate-100 px-3 py-2 text-xs font-semibold text-slate-600",onClick:f=>E(a.id)}," Marcar lida ",8,pt)),t("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-xl bg-slate-100 text-slate-500","aria-label":"Excluir",onClick:f=>L(a.id)},[...e[8]||(e[8]=[t("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M3 6h18"}),t("path",{d:"M8 6V4h8v2"}),t("path",{d:"M19 6l-1 16H6L5 6"}),t("path",{d:"M10 11v6"}),t("path",{d:"M14 11v6"})],-1)])],8,bt),a.read_at?c("",!0):(i(),n("span",ht))])])]))),128))]))]),_:1},16))],64))}});export{kt as default};

import{d as S,c as _,h as p,g as o,f as b,a as C,b as A,D as B,w as h,e,o as l,F as c,r as v,t as i,x as N,P as D,n as g,G as M,H as $,C as j,m as F}from"./app-gwvRBHRb.js";import{u as R,_ as V}from"./useIsMobile-CpoefEyf.js";import{_ as q}from"./DesktopShell.vue_vue_type_script_setup_true_lang-B6p_nF9i.js";import{_ as z}from"./AdminLayout.vue_vue_type_script_setup_true_lang-inbDMMcH.js";const G={class:"rounded-2xl bg-slate-50 p-6 ring-1 ring-slate-200/60"},J={class:"mt-4 grid gap-3 md:grid-cols-2"},O={class:"text-base font-semibold text-slate-900"},E={class:"mt-1 text-sm text-slate-600"},H={class:"mt-4 rounded-2xl bg-slate-50 p-6 ring-1 ring-slate-200/60"},I={class:"flex flex-wrap items-center justify-between gap-3"},L={class:"flex items-center gap-2"},U=["value"],K=["disabled"],Q={class:"mt-4 overflow-x-auto"},T={class:"min-w-full text-left text-sm"},W={class:"divide-y divide-slate-100"},X={class:"py-3 pr-4"},Y={class:"font-semibold text-slate-900"},Z={class:"mt-1 text-xs font-semibold text-slate-400"},ee={class:"py-3 pr-4 text-slate-600"},se={class:"py-3 pr-4 text-center"},te={key:0,class:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-emerald-50 text-emerald-700"},ae=["onClick","aria-label"],de=S({__name:"Roles",props:{roles:{},permissions:{},matrix:{}},setup(x){const f=R(),y=_(()=>f.value?V:q),w=_(()=>f.value?{showNav:!1}:{title:"Administração",showSearch:!1,showNewAction:!1}),u=x,a=p("user"),r=p(!1),m=p(JSON.parse(JSON.stringify(u.matrix))),d=(n,t)=>!!m.value?.[n]?.[t],k=(n,t)=>{n!=="admin"&&(m.value[n][t]=!d(n,t))},P=async()=>{r.value=!0,F.patch(route("admin.roles.update",a.value),{permissions:m.value[a.value]},{preserveScroll:!0,onFinish:()=>{r.value=!1}})};return(n,t)=>(l(),o(c,null,[b(A(B),{title:"Administração · Papéis e Permissões"}),(l(),C(j(y.value),M($(w.value)),{default:h(()=>[b(z,{title:"Papéis e Permissões",description:"Gerencie permissões por papel (admin sempre pode tudo)."},{default:h(()=>[e("div",G,[t[1]||(t[1]=e("div",{class:"text-sm font-semibold text-slate-900"},"Papéis",-1)),e("div",J,[(l(!0),o(c,null,v(x.roles,s=>(l(),o("div",{key:s.key,class:"rounded-2xl bg-slate-50 p-4 ring-1 ring-slate-200/60"},[e("div",O,i(s.label),1),e("div",E,i(s.description),1)]))),128))])]),e("div",H,[e("div",I,[t[2]||(t[2]=e("div",{class:"text-sm font-semibold text-slate-900"},"Permissões",-1)),e("div",L,[N(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value=s),class:"h-10 appearance-none rounded-xl border border-slate-200 bg-white px-3 pr-9 text-sm font-semibold text-slate-800","aria-label":"Selecionar papel"},[(l(!0),o(c,null,v(u.roles,s=>(l(),o("option",{key:s.key,value:s.key},i(s.label),9,U))),128))],512),[[D,a.value]]),e("button",{type:"button",class:"inline-flex items-center justify-center rounded-xl bg-[#14B8A6] px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-500/20 disabled:cursor-not-allowed disabled:opacity-60",disabled:r.value||a.value==="admin",onClick:P},i(r.value?"Salvando…":"Salvar"),9,K)])]),e("div",Q,[e("table",T,[t[3]||(t[3]=e("thead",{class:"text-xs font-bold uppercase tracking-wide text-slate-400"},[e("tr",null,[e("th",{class:"py-3 pr-4"},"Permissão"),e("th",{class:"py-3 pr-4"},"Descrição"),e("th",{class:"py-3 pr-4 text-center"},"Permitido")])],-1)),e("tbody",W,[(l(!0),o(c,null,v(u.permissions,s=>(l(),o("tr",{key:s.key},[e("td",X,[e("div",Y,i(s.label),1),e("div",Z,i(s.key),1)]),e("td",ee,i(s.description),1),e("td",se,[a.value==="admin"?(l(),o("div",te," ✓ ")):(l(),o("button",{key:1,type:"button",class:g(["inline-flex h-7 w-11 items-center rounded-full px-1 ring-1 transition",d(a.value,s.key)?"bg-[#14B8A6] ring-emerald-300/70":"bg-slate-100 ring-slate-200/70"]),onClick:le=>k(a.value,s.key),"aria-label":d(a.value,s.key)?"Desativar permissão":"Ativar permissão"},[e("span",{class:g(["h-5 w-5 rounded-full bg-white shadow-sm transition-transform",d(a.value,s.key)?"translate-x-4":"translate-x-0"])},null,2)],10,ae))])]))),128))])])]),t[4]||(t[4]=e("div",{class:"mt-4 text-xs font-semibold text-slate-400"}," Nota: o acesso real ao admin continua restrito ao e-mail `contato@kitamo.com.br` (isso não muda mesmo que você desmarque `admin.access`). ",-1))])]),_:1})]),_:1},16))],64))}});export{de as default};

import{d as H,c as y,h as x,N as M,g as r,f as C,a as O,b as a,D as W,w as A,e as t,t as i,x as n,o as d,F as T,r as P,P as b,I as p,i as S,n as j,G as J,H as K,C as Q,m as V}from"./app-C-UtfaCz.js";import{u as X,_ as Y}from"./useIsMobile-LrQea_ml.js";import{_ as Z}from"./DesktopShell.vue_vue_type_script_setup_true_lang-DniXuI_G.js";import{_ as ee}from"./Modal.vue_vue_type_script_setup_true_lang-BqPyGdI6.js";import{_ as te}from"./AdminLayout.vue_vue_type_script_setup_true_lang-D241VTQc.js";const se={class:"rounded-2xl bg-slate-50 p-6 ring-1 ring-slate-200/60"},le={class:"flex flex-wrap items-center justify-between gap-3"},oe={class:"mt-1 text-xs font-semibold text-slate-400"},ae={class:"mt-5 grid gap-3 md:grid-cols-[1fr_1fr_1fr_1.2fr]"},ne={class:"block"},de=["value"],re={class:"block"},ie={class:"block"},ue={class:"block"},pe={class:"mt-2 flex h-11 items-center gap-2 rounded-xl border border-slate-200 bg-white px-4"},xe={key:0,class:"mt-6 rounded-2xl border border-dashed border-slate-200 bg-slate-50 px-4 py-10 text-center"},be={key:1,class:"mt-6 space-y-3"},ce={class:"flex flex-wrap items-start justify-between gap-3"},me={class:"min-w-0"},fe={class:"flex flex-wrap items-center gap-2"},ve={class:"truncate text-base font-semibold text-slate-900"},ge={class:"mt-1 text-xs font-semibold text-slate-500"},ye={key:0},we={key:1},he={key:2},_e={key:3},ke={class:"flex flex-wrap items-center gap-2"},Ce=["onClick"],Ae=["onClick"],Te={key:0,class:"mt-3 rounded-xl bg-red-50 p-3 ring-1 ring-red-100"},Se={class:"mt-2 flex justify-end gap-2"},Ve=["disabled","onClick"],Ue={class:"p-6"},Ne={class:"flex items-start justify-between gap-4"},Be={class:"text-lg font-semibold text-slate-900"},$e={class:"mt-5 grid gap-4 md:grid-cols-2"},Ee={class:"block md:col-span-2"},Me={class:"block md:col-span-2"},Pe={class:"block"},je={class:"block"},De={class:"block"},Re={class:"block"},Fe={class:"block md:col-span-2"},Ie={class:"block md:col-span-2"},Le={class:"block"},qe={class:"block"},ze={key:0,class:"mt-4 rounded-2xl bg-red-50 p-4 text-sm font-semibold text-red-700"},Ge={class:"mt-6 flex items-center justify-end gap-2"},He=["disabled"],Xe=H({__name:"News",props:{items:{}},setup(D){const U=D,N=X(),R=y(()=>N.value?Y:Z),F=y(()=>N.value?{showNav:!1}:{title:"Administração",showSearch:!1,showNewAction:!1}),f=x("Todas"),v=x("Todos"),g=x("Todos"),w=x(""),I=y(()=>{const l=new Set;for(const e of U.items)e.category&&l.add(e.category);return["Todas",...Array.from(l.values()).sort((e,s)=>e.localeCompare(s))]}),h=y(()=>{const l=w.value.trim().toLowerCase();return U.items.filter(e=>f.value!=="Todas"&&(e.category||"")!==f.value||v.value!=="Todos"&&e.status!==v.value||g.value!=="Todos"&&e.type!==g.value?!1:l?`${e.title} ${e.content||""} ${e.category||""}`.toLowerCase().includes(l):!0)}),_=l=>{if(!l)return"";const e=new Date(l);return Number.isFinite(e.getTime())?e.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):String(l)},B=l=>l==="published"?{label:"Publicado",cls:"bg-emerald-50 text-emerald-700"}:l==="scheduled"?{label:"Agendado",cls:"bg-amber-50 text-amber-700"}:{label:"Rascunho",cls:"bg-slate-100 text-slate-700"},$=l=>l==="fix"?{label:"Correção",cls:"bg-red-50 text-red-700"}:l==="improvement"?{label:"Melhoria",cls:"bg-blue-50 text-blue-700"}:l==="announcement"?{label:"Aviso",cls:"bg-amber-50 text-amber-700"}:{label:"Novo",cls:"bg-emerald-50 text-emerald-700"},u=x(!1),c=x(null),o=M({title:"",category:"",type:"new",visibility:"public",status:"draft",scheduled_at:"",content:"",image_url:"",cta_text:"",cta_url:""}),L=()=>{c.value=null,o.reset(),o.clearErrors(),u.value=!0},q=l=>{c.value=l.id,o.reset(),o.clearErrors(),o.title=l.title,o.category=l.category??"",o.type=l.type||"new",o.visibility=l.visibility||"public",o.status=l.status||"draft",o.scheduled_at=l.scheduled_at?l.scheduled_at.slice(0,16):"",o.content=l.content??"",o.image_url=l.image_url??"",o.cta_text=l.cta_text??"",o.cta_url=l.cta_url??"",u.value=!0},z=()=>{if(o.transform(l=>({title:l.title,category:l.category||null,type:l.type,visibility:l.visibility,status:l.status,scheduled_at:l.scheduled_at||null,content:l.content||null,image_url:l.image_url||null,cta_text:l.cta_text||null,cta_url:l.cta_url||null})),c.value){o.patch(route("admin.news.update",c.value),{preserveScroll:!0,onSuccess:()=>{u.value=!1,V.reload({only:["items"]})}});return}o.post(route("admin.news.store"),{preserveScroll:!0,onSuccess:()=>{u.value=!1,V.reload({only:["items"]})}})},m=x(null),E=M({}),G=l=>{E.delete(route("admin.news.destroy",l),{preserveScroll:!0,onSuccess:()=>{m.value=null,V.reload({only:["items"]})}})};return(l,e)=>(d(),r(T,null,[C(a(W),{title:"Administração · Novidades"}),(d(),O(Q(R.value),J(K(F.value)),{default:A(()=>[C(te,{title:"Changelog",description:"Crie e publique novidades do sistema (modal de novidades para usuários)."},{default:A(()=>[t("div",se,[t("div",le,[t("div",null,[e[18]||(e[18]=t("div",{class:"text-sm font-semibold text-slate-900"},"Changelog",-1)),t("div",oe,i(h.value.length)+" item(ns)",1)]),t("div",{class:"flex flex-wrap items-center gap-2"},[t("button",{type:"button",class:"inline-flex items-center justify-center rounded-2xl bg-[#14B8A6] px-4 py-3 text-sm font-semibold text-white shadow-lg shadow-emerald-500/20",onClick:L}," + Adicionar novidade ")])]),t("div",ae,[t("label",ne,[e[19]||(e[19]=t("div",{class:"text-xs font-semibold text-slate-500"},"Categoria",-1)),n(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>f.value=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[(d(!0),r(T,null,P(I.value,s=>(d(),r("option",{key:s,value:s},i(s),9,de))),128))],512),[[b,f.value]])]),t("label",re,[e[21]||(e[21]=t("div",{class:"text-xs font-semibold text-slate-500"},"Status",-1)),n(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>v.value=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...e[20]||(e[20]=[t("option",{value:"Todos"},"Todos",-1),t("option",{value:"draft"},"Rascunho",-1),t("option",{value:"scheduled"},"Agendado",-1),t("option",{value:"published"},"Publicado",-1)])],512),[[b,v.value]])]),t("label",ie,[e[23]||(e[23]=t("div",{class:"text-xs font-semibold text-slate-500"},"Tipo",-1)),n(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>g.value=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...e[22]||(e[22]=[t("option",{value:"Todos"},"Todos",-1),t("option",{value:"new"},"Novo",-1),t("option",{value:"improvement"},"Melhoria",-1),t("option",{value:"fix"},"Correção",-1),t("option",{value:"announcement"},"Aviso",-1)])],512),[[b,g.value]])]),t("label",ue,[e[25]||(e[25]=t("div",{class:"text-xs font-semibold text-slate-500"},"Buscar",-1)),t("div",pe,[e[24]||(e[24]=t("svg",{class:"h-5 w-5 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("circle",{cx:"11",cy:"11",r:"7"}),t("path",{d:"M21 21l-4.3-4.3"})],-1)),n(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>w.value=s),type:"text",class:"w-full appearance-none border-0 bg-transparent p-0 text-sm font-semibold text-slate-800 placeholder:text-slate-400 outline-none focus:outline-none focus:ring-0",placeholder:"Buscar por título/conteúdo"},null,512),[[p,w.value]])])])]),h.value.length===0?(d(),r("div",xe,[...e[26]||(e[26]=[t("div",{class:"text-sm font-semibold text-slate-900"},"Nenhuma novidade encontrada",-1),t("div",{class:"mt-2 text-xs font-semibold text-slate-500"},"Ajuste os filtros ou crie uma novidade.",-1)])])):(d(),r("div",be,[(d(!0),r(T,null,P(h.value,s=>(d(),r("div",{key:s.id,class:"rounded-2xl bg-slate-50 p-4 ring-1 ring-slate-200/60"},[t("div",ce,[t("div",me,[t("div",fe,[t("div",ve,i(s.title),1),t("span",{class:j(["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",$(s.type).cls])},i($(s.type).label),3),t("span",{class:j(["inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",B(s.status).cls])},i(B(s.status).label),3)]),t("div",ge,[s.category?(d(),r("span",ye,i(s.category)+" • ",1)):S("",!0),s.published_at?(d(),r("span",we,"Publicado em "+i(_(s.published_at)),1)):s.scheduled_at?(d(),r("span",he,"Agendado para "+i(_(s.scheduled_at)),1)):(d(),r("span",_e,"Criado em "+i(_(s.created_at)),1))])]),t("div",ke,[t("button",{type:"button",class:"rounded-xl bg-white px-3 py-2 text-xs font-semibold text-slate-700 ring-1 ring-slate-200/60 hover:bg-slate-50",onClick:k=>q(s)}," Editar ",8,Ce),t("button",{type:"button",class:"rounded-xl bg-red-50 px-3 py-2 text-xs font-semibold text-red-700 ring-1 ring-red-100 hover:bg-red-100",onClick:k=>m.value=m.value===s.id?null:s.id}," Excluir ",8,Ae)])]),m.value===s.id?(d(),r("div",Te,[e[27]||(e[27]=t("div",{class:"text-xs font-semibold text-red-700"},"Tem certeza que deseja excluir?",-1)),t("div",Se,[t("button",{type:"button",class:"px-3 py-2 text-xs font-semibold text-slate-600",onClick:e[4]||(e[4]=k=>m.value=null)},"Cancelar"),t("button",{type:"button",class:"rounded-xl bg-red-600 px-3 py-2 text-xs font-semibold text-white disabled:opacity-60",disabled:a(E).processing,onClick:k=>G(s.id)}," Excluir agora ",8,Ve)])])):S("",!0)]))),128))]))])]),_:1})]),_:1},16)),C(ee,{show:u.value,maxWidth:"2xl",onClose:e[17]||(e[17]=s=>u.value=!1)},{default:A(()=>[t("div",Ue,[t("div",Ne,[t("div",null,[t("div",Be,i(c.value?"Editar novidade":"Nova novidade"),1),e[28]||(e[28]=t("div",{class:"mt-1 text-sm text-slate-500"},"Isso aparece no modal de novidades para os usuários.",-1))]),t("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-50 text-slate-600 ring-1 ring-slate-200/60","aria-label":"Fechar",onClick:e[5]||(e[5]=s=>u.value=!1)},[...e[29]||(e[29]=[t("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M6 6l12 12"}),t("path",{d:"M18 6l-12 12"})],-1)])])]),t("div",$e,[t("label",Ee,[e[30]||(e[30]=t("div",{class:"text-xs font-semibold text-slate-500"},"Título *",-1)),n(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>a(o).title=s),type:"text",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"Ex.: Melhorias na Estante"},null,512),[[p,a(o).title]])]),t("label",Me,[e[31]||(e[31]=t("div",{class:"text-xs font-semibold text-slate-500"},"Categoria (opcional)",-1)),n(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>a(o).category=s),type:"text",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"Ex.: Biblioteca, Perfil, Admin..."},null,512),[[p,a(o).category]])]),t("label",Pe,[e[33]||(e[33]=t("div",{class:"text-xs font-semibold text-slate-500"},"Tipo",-1)),n(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>a(o).type=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...e[32]||(e[32]=[t("option",{value:"new"},"Novo",-1),t("option",{value:"improvement"},"Melhoria",-1),t("option",{value:"fix"},"Correção",-1),t("option",{value:"announcement"},"Aviso",-1)])],512),[[b,a(o).type]])]),t("label",je,[e[35]||(e[35]=t("div",{class:"text-xs font-semibold text-slate-500"},"Visibilidade",-1)),n(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>a(o).visibility=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...e[34]||(e[34]=[t("option",{value:"public"},"Público",-1),t("option",{value:"admin"},"Apenas admin",-1)])],512),[[b,a(o).visibility]])]),t("label",De,[e[37]||(e[37]=t("div",{class:"text-xs font-semibold text-slate-500"},"Status",-1)),n(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>a(o).status=s),class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 pr-10 text-sm font-semibold text-slate-800"},[...e[36]||(e[36]=[t("option",{value:"draft"},"Rascunho",-1),t("option",{value:"scheduled"},"Agendado",-1),t("option",{value:"published"},"Publicado",-1)])],512),[[b,a(o).status]])]),t("label",Re,[e[38]||(e[38]=t("div",{class:"text-xs font-semibold text-slate-500"},"Agendar para (opcional)",-1)),n(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>a(o).scheduled_at=s),type:"datetime-local",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800"},null,512),[[p,a(o).scheduled_at]])]),t("label",Fe,[e[39]||(e[39]=t("div",{class:"text-xs font-semibold text-slate-500"},"Conteúdo",-1)),n(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>a(o).content=s),rows:"7",class:"mt-2 w-full resize-none appearance-none rounded-xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-800",placeholder:"Descreva a novidade..."},null,512),[[p,a(o).content]])]),t("label",Ie,[e[40]||(e[40]=t("div",{class:"text-xs font-semibold text-slate-500"},"Imagem (URL opcional)",-1)),n(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>a(o).image_url=s),type:"url",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"https://..."},null,512),[[p,a(o).image_url]])]),t("label",Le,[e[41]||(e[41]=t("div",{class:"text-xs font-semibold text-slate-500"},"CTA (texto opcional)",-1)),n(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>a(o).cta_text=s),type:"text",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"Saiba mais"},null,512),[[p,a(o).cta_text]])]),t("label",qe,[e[42]||(e[42]=t("div",{class:"text-xs font-semibold text-slate-500"},"CTA (URL opcional)",-1)),n(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>a(o).cta_url=s),type:"url",class:"mt-2 h-11 w-full appearance-none rounded-xl border border-slate-200 bg-white px-4 text-sm font-semibold text-slate-800",placeholder:"https://..."},null,512),[[p,a(o).cta_url]])])]),a(o).hasErrors?(d(),r("div",ze," Não foi possível salvar. Verifique os campos. ")):S("",!0),t("div",Ge,[t("button",{type:"button",class:"rounded-xl px-4 py-2 text-sm font-semibold text-slate-600",onClick:e[16]||(e[16]=s=>u.value=!1)},"Cancelar"),t("button",{type:"button",class:"rounded-xl bg-[#14B8A6] px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-500/20 disabled:opacity-60",disabled:a(o).processing,onClick:z},i(a(o).processing?"Salvando…":"Salvar"),9,He)])])]),_:1},8,["show"])],64))}});export{Xe as default};
